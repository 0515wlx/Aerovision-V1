# 航司识别训练配置
# ⚠️ 重要：相对路径相对于 /training/configs 目录
# 本配置适配 train_airline.py (航司识别分类训练脚本)

airline_training:
  # 训练轮数
  epochs: 100

  # 批次大小
  batch_size: 32

  # 图片尺寸
  image_size: 224

  # 数据加载线程数
  workers: 8

  # 混合精度训练
  amp: true

  # 模型配置
  model:
    # YOLOv8 预训练模型名称或路径
    name: "yolov8m-cls.pt"

  # 优化器配置
  optimizer:
    # 优化器类型: SGD, Adam, AdamW, NAdam, RAdam, RMSProp, auto
    type: "AdamW"

    # 初始学习率
    lr0: 0.001

    # SGD动量 或 Adam beta1
    momentum: 0.937

    # 权重衰减 (L2正则化)
    weight_decay: 0.0005

  # 学习率调度器
  scheduler:
    # 是否使用余弦学习率调度
    cosine: true

    # 最终学习率衰减比例 (final_lr = lr0 * lrf)
    lrf: 0.01

  # 正则化
  regularization:
    # 分类头的Dropout
    dropout: 0.1

  # 早停
  early_stopping:
    # 耐心值（多少个epoch没有改善就停止）
    patience: 0

  # Warmup配置
  warmup:
    # Warmup轮数
    epochs: 3.0

  # 输出配置
  output:
    # 项目根目录（YOLO训练结果保存位置）
    project: "../output/airline"

    # 实验名称
    name: "airline_classifier"

  # 保存周期（每N个epoch保存一次检查点，-1禁用）
  save_period: -1

  # 验证配置
  validation:
    # 是否启用验证
    enabled: true

  # 是否保存训练可视化图表
  plots: true

  # TensorBoard日志
  tensorboard: true

# ========================================
# 航司识别特定配置
# ========================================

# 数据配置
airline_data:
  # 航司分类数据集路径（相对于 training/configs）
  # 实际路径会从 splits/latest.txt 读取
  dataset_subdir: "aerovision/airline"

  # 类别映射文件
  classes_file: "../data/processed/labeled/airline_classes.json"

  # 最小样本数（低于此数量的航司类别将被过滤）
  min_samples_per_class: 8

  # 是否包含 "Unknown" 类别
  include_unknown: false

# 类别平衡配置
class_balance:
  # 是否启用类别平衡
  enabled: true

  # 平衡策略: oversample, undersample, weighted_loss
  strategy: "weighted_loss"

  # 类别权重计算方式: inverse_freq, sqrt_inverse_freq, effective_num
  weight_method: "sqrt_inverse_freq"

  # 最大权重限制（防止极端不平衡）
  max_weight: 10.0

# 数据增强配置（航司识别特定）
airline_augmentation:
  # 训练时增强
  train:
    # 水平翻转（航司涂装通常左右对称）
    horizontal_flip: 0.5

    # 垂直翻转（不建议，会破坏航司标识）
    vertical_flip: 0.0

    # 旋转角度范围
    rotation: 10

    # 缩放范围
    scale: [0.9, 1.1]

    # 色彩抖动
    color_jitter:
      brightness: 0.2
      contrast: 0.2
      saturation: 0.2
      hue: 0.1

    # 随机擦除（模拟遮挡）
    random_erasing:
      enabled: true
      probability: 0.3
      scale: [0.02, 0.2]

  # 验证/测试时增强（通常只做归一化）
  val:
    horizontal_flip: 0.0
    vertical_flip: 0.0

# 检查点配置
airline_checkpoints:
  # 检查点保存目录
  dir: "../ckpt/airline"

  # 日志目录
  log_dir: "../logs/airline"
