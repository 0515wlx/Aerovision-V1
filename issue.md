# AeroVision é¡¹ç›®é—®é¢˜æ¸…å•

> å®¡æ ¸æ—¶é—´ï¼š2026-01-06
> ç»“è®ºï¼š**è¿™ä¸ªé¡¹ç›®çš„ç®¡ç†æ˜¯ä¸€å›¢ç³Ÿ**

---

## è‡´å‘½é—®é¢˜

### 1. requirements.txt å®Œå…¨åºŸæ‰äº†

```
# å®é™…å†…å®¹é•¿è¿™æ ·ï¼š
ï¿½ï¿½a b s l - p y = = 2 .3 .1
a i s t u d i o - s d k = = 0 . 3 . 8
```

UTF-16 ç¼–ç ï¼Œæ¯ä¸ªå­—ç¬¦ä¹‹é—´å¤¹ç€ç©ºå­—ç¬¦ã€‚`pip install -r requirements.txt` ç›´æ¥æŠ¥é”™ã€‚

**è¿™ä¸æ˜¯ç–å¿½ï¼Œè¿™æ˜¯æ ¹æœ¬æ²¡æµ‹è¯•è¿‡ã€‚**

---

### 2. OpenCV ä¾èµ–æ‰“æ¶

åŒæ—¶è£…äº†ä¸‰ä¸ªäº’æ–¥çš„åŒ…ï¼š

```
opencv-python==4.12.0.88
opencv-python-headless==4.12.0.88
opencv-contrib-python==4.10.0.84
```

- `opencv-python` å’Œ `opencv-python-headless` ä¸èƒ½å…±å­˜
- ç‰ˆæœ¬å·è¿˜ä¸ä¸€è‡´ï¼ˆ4.12 vs 4.10ï¼‰

**åŸºæœ¬çš„ä¾èµ–ç®¡ç†éƒ½ä¸ä¼šã€‚**

---

### 3. æ–‡æ¡£æ˜¯å‡çš„

#### conductor.md ç”»çš„é¥¼ï¼š

```
training/
â”œâ”€â”€ src/                    # æºä»£ç 
â”‚   â”œâ”€â”€ data/               # Dataset ç±»
â”‚   â”œâ”€â”€ models/             # æ¨¡å‹å®šä¹‰
â”‚   â”œâ”€â”€ trainers/           # è®­ç»ƒå™¨
â”‚   â””â”€â”€ utils/              # å·¥å…·å‡½æ•°
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/                # åŸå§‹å›¾ç‰‡
â”‚   â”œâ”€â”€ processed/          # å¤„ç†åæ•°æ®
â”‚   â””â”€â”€ labels/             # æ ‡æ³¨æ–‡ä»¶
```

#### å®é™…æƒ…å†µï¼š

```bash
$ ls training/src/
ls: training/src/: No such file or directory

$ ls training/data/
ls: training/data/: No such file or directory
```

**æ•´ä¸ª src/ ç›®å½•å‹æ ¹ä¸å­˜åœ¨ã€‚data/ ç›®å½•ä¹Ÿä¸å­˜åœ¨ã€‚æ–‡æ¡£å†™çš„å…¨æ˜¯å¹»æƒ³ã€‚**

---

### 4. æŠ€æœ¯è·¯çº¿æ’’è°

#### conductor.md è¯´çš„ï¼š

> ä½¿ç”¨ timm + ConvNeXt/Swin Transformer
> å¤š Head è‡ªå®šä¹‰æ¨¡å‹æ¶æ„
> åˆ†é˜¶æ®µè®­ç»ƒï¼ˆStage 2-7ï¼‰

#### ä»£ç å®é™…ç”¨çš„ï¼š

```python
# train_classify.py ç¬¬ 45 è¡Œ
from ultralytics import YOLO
```

**å…¨æ˜¯ YOLOv8ï¼Œæ²¡æœ‰ä¸€è¡Œ ConvNeXt æˆ– Swin çš„ä»£ç ã€‚**

ä½†é…ç½®æ–‡ä»¶é‡Œè¿˜ç•™ç€è¿™ç§åºŸè¯ï¼š

```yaml
# training.yaml ç¬¬ 103-118 è¡Œ
custom_model:
  backbone: "convnext"
  convnext:
    model_name: "convnext_base"
  swin:
    model_name: "swin_base_patch4_window7_224"
```

**å†™äº†ä¸€å †ä»æ¥æ²¡ç”¨è¿‡çš„é…ç½®ï¼Œå¢åŠ ç»´æŠ¤æˆæœ¬å’Œç†è§£æˆæœ¬ã€‚**

---

### 5. é˜¶æ®µæ–‡æ¡£ç¼ºå¤± 50%

conductor.md æ‰¿è¯ºçš„æ–‡æ¡£ï¼š

| æ–‡æ¡£ | çŠ¶æ€ |
|------|------|
| stage0_environment.md | âœ… å­˜åœ¨ |
| stage1_data_preparation.md | âœ… å­˜åœ¨ |
| stage2_single_task.md | âŒ **ä¸å­˜åœ¨** |
| stage3_multi_head.md | âŒ **ä¸å­˜åœ¨** |
| stage4_quality_block.md | âœ… å­˜åœ¨ |
| stage5_hybrid.md | âŒ **ä¸å­˜åœ¨** |
| stage6_ocr.md | âœ… å­˜åœ¨ |
| stage7_integration.md | âŒ **ä¸å­˜åœ¨** |

**æ‰¿è¯º 8 ä¸ªæ–‡æ¡£ï¼Œå®é™…åªå†™äº† 4 ä¸ªã€‚**

è€Œä¸” stage2/3/5 æ˜¯æ ¸å¿ƒè®­ç»ƒé˜¶æ®µçš„æ–‡æ¡£ï¼Œå…¨éƒ¨ç¼ºå¤±ã€‚

---

## é…ç½®ç®¡ç†æ··ä¹±

### 6. åŒä¸€ä¸ªå‚æ•°ï¼ŒN ä¸ªæ–‡ä»¶å®šä¹‰ï¼ŒN ä¸ªä¸åŒçš„å€¼

| å‚æ•° | training.yaml | training_params.yaml | airline.yaml | yolo.yaml |
|------|---------------|----------------------|--------------|-----------|
| epochs | 100 | 50 | 100 | 100 |
| batch_size | 32 | 8 | 32 | 16 |
| image_size | 224 | 640 | 224 | 640 |
| device | (æœªå®šä¹‰) | "cpu" | (æœªå®šä¹‰) | (æœªå®šä¹‰) |

**åˆ°åº•ç”¨å“ªä¸ªï¼Ÿæ²¡äººçŸ¥é“ã€‚**

---

### 7. é…ç½®æ–‡ä»¶å‘½åä¹Ÿæ˜¯å‡çš„

conductor.md è¯´é…ç½®æ˜¯ï¼š
```
configs/
â”œâ”€â”€ stage2_type.yaml
â”œâ”€â”€ stage3_multi.yaml
â””â”€â”€ stage5_hybrid.yaml
```

å®é™…æ˜¯ï¼š
```
configs/
â”œâ”€â”€ base.yaml
â””â”€â”€ config/
    â”œâ”€â”€ paths.yaml
    â”œâ”€â”€ training.yaml
    â”œâ”€â”€ airline.yaml
    â””â”€â”€ ...
```

**æ–‡æ¡£å’Œä»£ç å®Œå…¨å¯¹ä¸ä¸Šã€‚**

---

### 8. ç¯å¢ƒå˜é‡ç¡¬ç¼–ç åœ¨ä»£ç é‡Œ

```python
# ocr/paddle_ocr.py
os.environ['DISABLE_MODEL_SOURCE_CHECK'] = 'True'
os.environ['PADDLEX_LOG_LEVEL'] = 'ERROR'

# train_classify.py
os.environ['YOLO_CONFIG_DIR'] = str(training_root / 'model')
```

- æ²¡æœ‰ `.env` æ–‡ä»¶
- æ²¡æœ‰ `.env.example` æ¨¡æ¿
- ç¯å¢ƒå˜é‡æ•£è½åœ¨å„ä¸ªè„šæœ¬é‡Œ

**é…ç½®ç®¡ç† 101 éƒ½ä¸ä¼šã€‚**

---

## ä»£ç è´¨é‡é—®é¢˜

### 9. è®­ç»ƒè„šæœ¬å¤åˆ¶ç²˜è´´

| æ–‡ä»¶ | è¡Œæ•° |
|------|------|
| train_classify.py | 918 |
| train_airline.py | 911 |
| train_detection.py | 504 |

ä¸‰ä¸ªè„šæœ¬çš„ `parse_arguments()`ã€`setup_logging()` å‡½æ•°å‡ ä¹ä¸€æ¨¡ä¸€æ ·ã€‚

**2333 è¡Œä»£ç ï¼Œè‡³å°‘ 30% æ˜¯é‡å¤çš„ã€‚**

---

### 10. sys.path æ»¥ç”¨

9 ä¸ªæ–‡ä»¶éƒ½æœ‰è¿™ç§æ“ä½œï¼š

```python
sys.path.insert(0, str(Path(__file__).parent.parent))
from configs import load_config
```

**ä¸ä¼šç”¨ `setup.py` æˆ– `pyproject.toml` åšæˆå¯å®‰è£…åŒ…å—ï¼Ÿ**

---

### 11. æµ‹è¯•è¦†ç›–ç‡çº¦ç­‰äºé›¶

æµ‹è¯•æ–‡ä»¶æ€»æ•°ï¼š**0**

åªæœ‰ 3 ä¸ªéªŒè¯è„šæœ¬ï¼š
- `check_gpu.py` - æ£€æŸ¥ GPU
- `verify_env.py` - æ£€æŸ¥ç¯å¢ƒ
- `verify_data.py` - æ£€æŸ¥æ•°æ®

**æ²¡æœ‰å•å…ƒæµ‹è¯•ï¼Œæ²¡æœ‰é›†æˆæµ‹è¯•ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚**

---

## æ•°æ®æµç¨‹é—®é¢˜

### 12. æ–‡æ¡£è¯´çš„æ•°æ®æµç¨‹ vs å®é™…è„šæœ¬

**conductor.md è¯´çš„ï¼š**
```
åŸå§‹å›¾ç‰‡ â†’ crop_airplane.py â†’ aircraft_crop/unsorted â†’ æ ‡æ³¨ â†’ train/val/test
```

**å®é™…è„šæœ¬åšçš„ï¼š**
```
åŸå§‹å›¾ç‰‡ â†’ prepare_dataset.py â†’ prepared/<timestamp>/ â†’ split_dataset.py â†’ splits/<timestamp>/
```

- å¤šäº† `prepare_dataset.py` è¿™ä¸€æ­¥ï¼ˆæ–‡æ¡£æ²¡æï¼‰
- è¾“å‡ºç›®å½•å¸¦æ—¶é—´æˆ³ï¼ˆæ–‡æ¡£æ²¡è¯´ï¼‰
- ä¸­é—´å¤šäº† `prepared/` å’Œ `splits/` ä¸¤å±‚ç›®å½•

**æŒ‰ç…§æ–‡æ¡£æ“ä½œä¼šä¸€è„¸æ‡µé€¼ã€‚**

---

### 13. è·¯å¾„å¼•ç”¨ä¸‰ç§é£æ ¼æ··ç”¨

**é£æ ¼ 1ï¼šé…ç½®æ–‡ä»¶ç›¸å¯¹è·¯å¾„**
```yaml
# paths.yaml
data.splits.root: "../data/splits"
```

**é£æ ¼ 2ï¼šè„šæœ¬é‡Œç¡¬ç¼–ç **
```python
# train_classify.py
data_path = "../data/prepared/20260102_221524/aerovision/aircraft"
```

**é£æ ¼ 3ï¼šé…ç½®åŠ è½½å™¨**
```python
config.get_path('data.splits.root')
```

**ä¸‰ç§é£æ ¼æ··ç€ç”¨ï¼Œå‡ºé—®é¢˜äº†éƒ½ä¸çŸ¥é“è¯¥æŸ¥å“ªé‡Œã€‚**

---

## é¡¹ç›®ç®¡ç†é—®é¢˜

### 14. æŠ€æœ¯æ–¹æ¡ˆå¤§è½¬å¼¯ä½†æ²¡å‘Šè¯‰ä»»ä½•äºº

è¯æ®é“¾ï¼š

1. conductor.md æè¿°çš„æ˜¯è‡ªç ” ConvNeXt/Swin å¤š Head æ¨¡å‹
2. training/README.md è¯´ç”¨ YOLOv8
3. ä»£ç å®é™…ç”¨çš„æ˜¯ YOLOv8
4. conductor.md ä»æ¥æ²¡æ›´æ–°è¿‡

**ç»“è®ºï¼šé¡¹ç›®ä¸­é€”æ”¾å¼ƒäº†åŸè®¡åˆ’ï¼Œæ”¹ç”¨ YOLOv8 ç®€åŒ–å®ç°ï¼Œä½†æ²¡äººæ›´æ–°æ–‡æ¡£ã€‚**

è¿™å¯¼è‡´ï¼š
- æ–°äººçœ‹ conductor.md ä¼šå®Œå…¨èµ°å
- é…ç½®æ–‡ä»¶é‡Œç•™ç€ä¸€å †åºŸå¼ƒé…ç½®
- é˜¶æ®µæ–‡æ¡£ç¼ºå¤±æ˜¯å› ä¸ºå‹æ ¹å°±æ²¡æŒ‰åŸè®¡åˆ’åš

---

### 15. training/docs/workflow.md æ›´æ–°æ—¥å¿—è‡ªæ›

```markdown
| v2.0 | 2026-01-02 | é‡æ„ä¸ºä¸“æ³¨äºæ£€æµ‹ä»»åŠ¡ï¼Œåˆ é™¤åˆ†ç±»ç›¸å…³å†…å®¹ |
```

**æ‰¿è®¤äº†æŠ€æœ¯æ–¹æ¡ˆå˜æ›´ï¼Œä½† conductor.md ä¾ç„¶æ˜¯æ—§ç‰ˆæè¿°ã€‚**

---

## æ€»ç»“

| é—®é¢˜ç±»åˆ« | æ•°é‡ | ä¸¥é‡ç¨‹åº¦ |
|----------|------|----------|
| è‡´å‘½é—®é¢˜ | 5 | ğŸ”´ é¡¹ç›®æ— æ³•è¿è¡Œ |
| é…ç½®æ··ä¹± | 3 | ğŸŸ  ç»´æŠ¤å™©æ¢¦ |
| ä»£ç è´¨é‡ | 3 | ğŸŸ¡ æŠ€æœ¯å€º |
| æ•°æ®æµç¨‹ | 2 | ğŸŸ  æ–°äººé™·é˜± |
| é¡¹ç›®ç®¡ç† | 2 | ğŸ”´ æ ¹æœ¬åŸå›  |

**æ ¹æœ¬é—®é¢˜ï¼šè¿™ä¸ªé¡¹ç›®ç»å†äº†ä¸€æ¬¡æœªç»è®°å½•çš„æŠ€æœ¯æ–¹æ¡ˆå¤§è½¬å¼¯ï¼Œä»"è‡ªç ”å¤æ‚æ¨¡å‹"å˜æˆäº†"ç›´æ¥ç”¨ YOLOv8"ï¼Œä½†æ‰€æœ‰æ–‡æ¡£ã€é…ç½®ã€ç›®å½•ç»“æ„éƒ½åœç•™åœ¨åŸè®¡åˆ’é˜¶æ®µã€‚**

---

## å¦‚æœè¦ä¿®çš„è¯

### å¿…é¡»ç«‹å³ä¿®å¤

1. ç”¨æ­£ç¡®ç¼–ç é‡æ–°ç”Ÿæˆ `requirements.txt`
2. åˆ æ‰å†²çªçš„ OpenCV ä¾èµ–
3. è¦ä¹ˆæ›´æ–° conductor.md åæ˜ å®é™…æŠ€æœ¯æ ˆï¼Œè¦ä¹ˆåˆ æ‰å®ƒ

### åº”è¯¥å°½å¿«ä¿®å¤

4. åˆ æ‰é…ç½®æ–‡ä»¶é‡Œä»æ¥æ²¡ç”¨è¿‡çš„ ConvNeXt/Swin é…ç½®
5. ç»Ÿä¸€é…ç½®å‚æ•°ï¼Œæ¶ˆé™¤é‡å¤å®šä¹‰
6. åˆ›å»º `.env.example` æ¨¡æ¿

### æœ‰ç©ºå†è¯´

7. é‡æ„è®­ç»ƒè„šæœ¬ï¼Œæå–å…¬å…±ä»£ç 
8. æŠŠé¡¹ç›®åšæˆå¯å®‰è£…åŒ…
9. å†™æµ‹è¯•ï¼ˆè™½ç„¶ä¼°è®¡æ°¸è¿œä¸ä¼šå†™ï¼‰

---

**è¯„ä»·ï¼šè¿™ä¸æ˜¯ä¸€ä¸ªæˆç†Ÿçš„é¡¹ç›®ï¼Œè¿™æ˜¯ä¸€ä¸ªåŸå‹éªŒè¯é˜¶æ®µçš„ä»£ç è¢«é”™è¯¯åœ°å½“æˆäº†æ­£å¼é¡¹ç›®ã€‚**
